{"version":3,"file":"js/360.2831e441.js","mappings":"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","sources":["webpack://gene-curator/./src/views/PreCurationTable.vue","webpack://gene-curator/./src/components/ConfirmationModal.vue","webpack://gene-curator/./src/components/ConfirmationModal.vue?017d","webpack://gene-curator/./src/views/PreCurationTable.vue?160e"],"sourcesContent":["<!--components/PreCurationTable.vue-->\n<template>\n  <v-container>\n    <h1>Pre-Curation Table</h1>\n\n    <!-- Data table component -->\n    <DataDisplayTable\n      :headers=\"headers\"\n      :items=\"paginatedItems\"\n      :config=\"tableConfig\"\n      :total-items=\"totalItems\"\n      :loading=\"loading\"\n      @page-changed=\"updatePage\"\n      @items-per-page-changed=\"updateItemsPerPage\"\n    >\n\n      <template v-slot:action-slot=\"{ item }\" v-if=\"isCuratorOrAdmin\">\n        <v-btn color=\"primary\" @click=\"openModal(item)\">Edit</v-btn>\n        <v-btn color=\"green\" @click=\"approveItem(item)\">\n          <v-icon left v-if=\"item.approvedBy\">mdi-check</v-icon>\n          Approve\n        </v-btn>\n        <v-btn color=\"error\" @click=\"deleteItem(item)\">Delete</v-btn>\n      </template>\n\n      <template v-slot:modal>\n        <CurationModal :item=\"selectedItem\" :open=\"showModal\" context=\"precuration\" @close=\"closeModal\" />\n      </template>\n\n    </DataDisplayTable>\n\n    <ConfirmationModal\n      :visible=\"confirmModalVisible\"\n      :title=\"confirmModalTitle\"\n      :message=\"confirmModalMessage\"\n      @confirm=\"onConfirm\"\n      @cancel=\"onCancel\"\n    />\n  </v-container>\n</template>\n\n<script>\nimport { ref, onMounted, computed } from 'vue';\nimport DataDisplayTable from '@/components/DataDisplayTable.vue';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\nimport CurationModal from '@/components/CurationModal.vue';\nimport ConfirmationModal from '@/components/ConfirmationModal.vue';\nimport { getPrecurations, deletePrecuration, updatePrecuration } from '@/stores/precurationsStore';\nimport { precurationDetailsConfig } from '@/config/workflows/KidneyGeneticsGeneCuration/workflowConfig';\n\nexport default {\n  name: 'PreCurationTable',\n  components: {\n    DataDisplayTable,\n    CurationModal,\n    ConfirmationModal\n  },\n  setup() {\n    const rawItems = ref({});\n    const loading = ref(false);\n    const page = ref(1);\n    const itemsPerPage = ref(10);\n\n    // Firebase auth setup\n    const auth = getAuth();\n    const user = ref(null);\n\n    // Modal control state\n    const showModal = ref(false);\n    const selectedItem = ref({});\n\n    // Computed properties for UI\n    const isLoggedIn = computed(() => !!user.value);\n    const totalItems = computed(() => Object.keys(rawItems.value).length);\n    const paginatedItems = computed(() => {\n      const start = (page.value - 1) * itemsPerPage.value;\n      const end = start + itemsPerPage.value;\n      return Object.values(rawItems.value).slice(start, end);\n    });\n\n    // Dynamically define headers based on user role and\n    // create headers dynamically based on the precurationDetailsConfig\n    const headers = computed(() => {\n      const dynamicHeaders = Object.entries(precurationDetailsConfig)\n        .filter(([, config]) => config.visibility.tableView)\n        .map(([key, config]) => ({\n          title: config.label,\n          value: key,\n          sortable: config.format !== 'array' && config.format !== 'map',\n          description: config.description // Add the description for the tooltip\n        }));\n\n      // Add 'Actions' header if user is curator or admin\n      if (isCuratorOrAdmin.value) {\n        dynamicHeaders.push({ title: 'Actions', value: 'actions', sortable: false });\n      }\n\n      return dynamicHeaders;\n    });\n\n    const tableConfig = {\n      columns: [\n        {\n          name: 'approved_symbol',\n          type: 'link', // Types can be 'text', 'link', 'action', etc.\n          to: item => `/gene/${item.hgnc_id}` // Function to generate the link\n        },\n        {\n          name: 'createdAt',\n          type: 'date'\n        },\n        {\n          name: 'actions',\n          type: 'slot',\n          slotName: 'action-slot'\n        }\n      ]\n    };\n\n    // Function to handle modal opening\n    const openModal = (item) => {\n      selectedItem.value = item;\n      showModal.value = true;\n    };\n\n    // Function to handle modal closure\n    const closeModal = () => {\n      showModal.value = false;\n    };\n\n    const updatePage = (newPage) => {\n      page.value = newPage;\n    };\n\n    const updateItemsPerPage = (newItemsPerPage) => {\n      itemsPerPage.value = newItemsPerPage;\n    };\n\n    const confirmModalVisible = ref(false);\n    const confirmModalTitle = ref('');\n    const confirmModalMessage = ref('');\n    let currentAction = null;\n\n    const openConfirmModal = (title, message, action) => {\n      confirmModalTitle.value = title;\n      confirmModalMessage.value = message;\n      currentAction = action;\n      confirmModalVisible.value = true;\n    };\n\n    const onConfirm = () => {\n      if (currentAction) {\n        currentAction();\n      }\n      confirmModalVisible.value = false;\n    };\n\n    const onCancel = () => {\n      confirmModalVisible.value = false;\n    };\n\n    // Function for updating the local state after an item is deleted or approved\n    const updateLocalState = (itemId, updatedData = null) => {\n      if (updatedData) {\n        // Update the item data if it exists (for approval)\n        rawItems.value[itemId] = updatedData;\n      } else {\n        // Delete the item from the local state (for deletion)\n        delete rawItems.value[itemId];\n      }\n      // Trigger reactivity\n      rawItems.value = {...rawItems.value};\n    };\n\n    // Function to delete an item\n    const deleteItem = async (item) => {\n      openConfirmModal(\n        'Delete Precuration',\n        'Are you sure you want to delete this precuration?',\n        async () => {\n          if (item && item.id) {\n            await deletePrecuration(item.id);\n            updateLocalState(item.id);\n          } else {\n            console.error('Item ID is undefined or invalid');\n          }\n        }\n      );\n    };\n\n    // Function to approve an item\n    const approveItem = async (item) => {\n      openConfirmModal(\n        'Approve Precuration',\n        'Are you sure you want to approve this precuration?',\n        async () => {\n          if (item && item.id) {\n            const updatedData = {\n              ...item,\n              approvedBy: user.value.uid,\n              approvedAt: new Date()\n            };\n            await updatePrecuration(item.id, updatedData);\n            updateLocalState(item.id, updatedData);\n          } else {\n            console.error('Item ID is undefined or invalid');\n          }\n        }\n      );\n    };\n\n    onMounted(async () => {\n      loading.value = true;\n      rawItems.value = await getPrecurations();\n      loading.value = false;\n    });\n    \n    onAuthStateChanged(auth, (loggedInUser) => {\n      user.value = loggedInUser; // Update user state on auth change\n    });\n\n    // Computed property to check if the user is a curator or admin\n    const isCuratorOrAdmin = computed(() => {\n      const user = JSON.parse(localStorage.getItem('user'));\n      return user && (user.role === 'curator' || user.role === 'admin');\n    });\n\n    return {\n      headers,\n      paginatedItems,\n      tableConfig,\n      totalItems,\n      loading,\n      isLoggedIn,\n      showModal,\n      selectedItem,\n      openModal,\n      closeModal,\n      updatePage,\n      updateItemsPerPage,\n      deleteItem,\n      isCuratorOrAdmin,\n      openConfirmModal,\n      onConfirm,\n      onCancel,\n      confirmModalVisible,\n      confirmModalTitle,\n      confirmModalMessage,\n      approveItem,\n      updateLocalState\n    };\n  },\n};\n</script>\n\n<style scoped>\n/* Add your CSS styling here */\n</style>\n","<!-- components/ConfirmationModal.vue -->\n<template>\n  <v-dialog v-model=\"internalVisible\" max-width=\"400px\">\n    <v-card>\n      <v-card-title>{{ title }}</v-card-title>\n      <v-card-text>{{ message }}</v-card-text>\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn color=\"green\" @click=\"confirmAction\">Yes</v-btn>\n        <v-btn color=\"red\" @click=\"cancelAction\">No</v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nexport default {\n  props: {\n    visible: Boolean,\n    title: String,\n    message: String\n  },\n  emits: ['confirm', 'cancel', 'update:visible'],\n  computed: {\n    internalVisible: {\n      get() {\n        return this.visible;\n      },\n      set(value) {\n        this.$emit('update:visible', value);\n      }\n    }\n  },\n  methods: {\n    confirmAction() {\n      this.$emit('confirm');\n      this.$emit('update:visible', false);\n    },\n    cancelAction() {\n      this.$emit('cancel');\n      this.$emit('update:visible', false);\n    }\n  }\n};\n</script>\n","import { render } from \"./ConfirmationModal.vue?vue&type=template&id=61478dac\"\nimport script from \"./ConfirmationModal.vue?vue&type=script&lang=js\"\nexport * from \"./ConfirmationModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./PreCurationTable.vue?vue&type=template&id=4c708a2f&scoped=true\"\nimport script from \"./PreCurationTable.vue?vue&type=script&lang=js\"\nexport * from \"./PreCurationTable.vue?vue&type=script&lang=js\"\n\nimport \"./PreCurationTable.vue?vue&type=style&index=0&id=4c708a2f&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4c708a2f\"]])\n\nexport default __exports__"],"names":["_createElementVNode","_createBlock","_component_v_container","_hoisted_1","_createVNode","_component_DataDisplayTable","headers","$setup","items","paginatedItems","config","tableConfig","totalItems","loading","onPageChanged","updatePage","onItemsPerPageChanged","updateItemsPerPage","modal","_withCtx","_component_CurationModal","item","selectedItem","open","showModal","context","onClose","closeModal","isCuratorOrAdmin","_component_v_btn","color","onClick","$event","openModal","approveItem","approvedBy","_component_v_icon","left","deleteItem","_component_ConfirmationModal","visible","confirmModalVisible","title","confirmModalTitle","message","confirmModalMessage","onConfirm","onCancel","_component_v_dialog","$options","internalVisible","_component_v_card","_component_v_card_title","$props","_component_v_card_text","_component_v_card_actions","_component_v_spacer","confirmAction","cancelAction","props","Boolean","String","emits","computed","get","this","set","value","$emit","methods","__exports__","name","components","DataDisplayTable","CurationModal","ConfirmationModal","setup","rawItems","ref","page","itemsPerPage","auth","getAuth","user","isLoggedIn","Object","keys","length","start","end","values","slice","dynamicHeaders","entries","precurationDetailsConfig","filter","visibility","tableView","map","key","label","sortable","format","description","push","columns","type","to","hgnc_id","slotName","newPage","newItemsPerPage","currentAction","openConfirmModal","action","updateLocalState","itemId","updatedData","async","id","deletePrecuration","console","error","uid","approvedAt","Date","updatePrecuration","onMounted","getPrecurations","onAuthStateChanged","loggedInUser","JSON","parse","localStorage","getItem","role","render"],"sourceRoot":""}