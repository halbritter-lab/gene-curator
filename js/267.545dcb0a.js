"use strict";(self["webpackChunkgene_curator"]=self["webpackChunkgene_curator"]||[]).push([[267],{6160:function(e,a,t){var r=t(6056),o=t(4690),i=t(5573);const l={signInWithGoogle:async()=>{try{const e=new o.hJ,a=await(0,o.rh)(r.I,e);await n(a.user);const t=await(0,i.CX)(a.user.email);return t}catch(e){throw console.error(e),e}},registerWithEmail:async(e,a)=>{try{const t=await(0,o.Xb)(r.I,e,a);await n(t.user);const l=await(0,i.CX)(t.user.email);return l}catch(t){throw console.error(t),t}},loginWithEmail:async(e,a)=>{try{const t=await(0,o.e5)(r.I,e,a),l=await(0,i.CX)(t.user.email);return l}catch(t){throw console.error(t),t}},signOut:async()=>{try{await(0,o.w7)(r.I)}catch(e){throw console.error(e),e}}};async function n(e){const a=await(0,i.CX)(e.email);if(!a){const a=await(0,i.Rf)(),t=0===Object.keys(a).length,r=t?"admin":"viewer";await(0,i.r4)({uid:e.uid,email:e.email,role:r,createdAt:new Date,updatedAt:new Date},e.uid)}}a.Z=l},92:function(e,a,t){t.d(a,{Z:function(){return u}});var r=t(3396),o=t(7139);function i(e,a,t,i,l,n){const s=(0,r.up)("v-card-title"),u=(0,r.up)("v-card-text"),c=(0,r.up)("v-spacer"),d=(0,r.up)("v-btn"),m=(0,r.up)("v-card-actions"),g=(0,r.up)("v-card"),p=(0,r.up)("v-dialog");return(0,r.wg)(),(0,r.j4)(p,{width:"470"},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{style:{padding:"10px 0"}},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{style:{"font-family":"google-sans, sans-serif","font-size":"24px"}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,o.zw)(t.error.title),1)])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,o.zw)(t.error.message),1)])),_:1}),(0,r.Wm)(m,null,{default:(0,r.w5)((()=>[(0,r.Wm)(c),(0,r.Wm)(d,{color:"primary",elevation:"0",onClick:a[0]||(a[0]=a=>e.$emit("value",!1))},{default:(0,r.w5)((()=>[(0,r.Uk)("Ok")])),_:1})])),_:1})])),_:1})])),_:1})}var l={name:"ErrorDialog",props:{error:{type:Object,default:()=>({})}}},n=t(89);const s=(0,n.Z)(l,[["render",i]]);var u=s},1086:function(e,a,t){t.d(a,{Z:function(){return c}});var r=t(3396),o=t(7139);const i={style:{"margin-left":"20px","margin-bottom":"0"}};function l(e,a,t,l,n,s){const u=(0,r.up)("v-progress-circular"),c=(0,r.up)("v-card"),d=(0,r.up)("v-dialog");return(0,r.wg)(),(0,r.j4)(d,{width:"200",value:t.value,onInput:a[0]||(a[0]=a=>e.$emit("value",!1)),persistent:""},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{style:{padding:"20px","text-align":"left",display:"flex","flex-direction":"row","align-items":"center"}},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{indeterminate:"",color:"primary"}),(0,r._)("p",i,(0,o.zw)(t.message),1)])),_:1})])),_:1},8,["value"])}var n={name:"LoadingDialog",model:{prop:"value",event:"value"},props:{value:{type:Boolean,default:!1},message:{type:String,default:""}}},s=t(89);const u=(0,s.Z)(n,[["render",l]]);var c=u},3267:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var r=t(3396),o=t(9242);const i={class:"d-flex justify-space-between align-center mt-2"},l=(0,r._)("div",{class:"login-divider"},"OR",-1);function n(e,a,t,n,s,u){const c=(0,r.up)("v-card-title"),d=(0,r.up)("v-text-field"),m=(0,r.up)("v-btn"),g=(0,r.up)("v-form"),p=(0,r.up)("v-card-text"),w=(0,r.up)("v-card"),h=(0,r.up)("error-dialog"),v=(0,r.up)("loading-dialog"),f=(0,r.up)("v-container");return(0,r.wg)(),(0,r.j4)(f,{class:"fill-height d-flex align-center justify-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{class:"pa-5",style:{width:"600px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{class:"text-center text-h5 mb-4"},{default:(0,r.w5)((()=>[(0,r.Uk)("Login")])),_:1}),(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[(0,r.Wm)(g,{ref:"loginForm",onSubmit:(0,o.iM)(u.loginWithEmail,["prevent"])},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{color:"primary",label:"Email",modelValue:s.email,"onUpdate:modelValue":a[0]||(a[0]=e=>s.email=e),type:"email",rules:[e=>!!e||"Email is required",e=>/.+@.+/.test(e)||"Email must be valid"],variant:"outlined",class:"mb-2"},null,8,["modelValue","rules"]),(0,r.Wm)(d,{color:"primary",label:"Password",modelValue:s.password,"onUpdate:modelValue":a[1]||(a[1]=e=>s.password=e),type:"password",rules:[e=>!!e&&e.length>=6||"Password must be at least 6 characters"],variant:"outlined"},null,8,["modelValue","rules"]),(0,r._)("div",i,[(0,r.Wm)(m,{type:"submit",color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("Login")])),_:1}),(0,r.Wm)(m,{onClick:u.navigateToRegister,variant:"text",class:"text-decoration-underlined"},{default:(0,r.w5)((()=>[(0,r.Uk)(" Don't have an account? Register ")])),_:1},8,["onClick"])]),l,(0,r.Wm)(m,{onClick:u.signInWithGoogle,color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)(" Login with Google")])),_:1},8,["onClick"])])),_:1},8,["onSubmit"])])),_:1})])),_:1}),(0,r.Wm)(h,{modelValue:s.error,"onUpdate:modelValue":a[2]||(a[2]=e=>s.error=e),error:s.errorVal,onValue:a[3]||(a[3]=e=>s.error=e)},null,8,["modelValue","error"]),(0,r.Wm)(v,{modelValue:s.loading,"onUpdate:modelValue":a[4]||(a[4]=e=>s.loading=e),message:"Please wait..."},null,8,["modelValue"])])),_:1})}t(560);var s=t(6160),u=t(2483),c=t(92),d=t(1086),m={name:"LoginUser",components:{ErrorDialog:c.Z,LoadingDialog:d.Z},data(){return{error:!1,errorVal:{},loading:!1,email:"",password:""}},setup(){const e=(0,u.tv)();return{router:e}},methods:{async loginWithEmail(){const{valid:e}=await this.$refs.loginForm.validate();if(e)try{this.loading=!0;const e=await s.Z.loginWithEmail(this.email,this.password);this.saveUserToLocalStorage(e),this.router.push("/"),this.loading=!1}catch(a){this.loading=!1,console.error(a),this.error=!0,this.errorVal={title:"Login Error",message:"There was an error logging you in. Please try again."}}},async signInWithGoogle(){try{const e=await s.Z.signInWithGoogle();this.saveUserToLocalStorage(e),this.router.push("/")}catch(e){console.error(e),this.error=!0,this.errorVal={title:"Login Error",message:"There was an error logging you in with Google. Please try again."}}},navigateToRegister(){this.router.push("/register")},saveUserToLocalStorage(e){e&&(localStorage.setItem("user",JSON.stringify({email:e.email,displayName:e.displayName||e.email,uid:e.uid,role:e.role||"viewer",permissions:e.permissions})),localStorage.setItem("isLoggedIn","true"))}}},g=t(89);const p=(0,g.Z)(m,[["render",n]]);var w=p}}]);
//# sourceMappingURL=267.545dcb0a.js.map