{"version":3,"file":"js/489.b7f37317.js","mappings":"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","sources":["webpack://gene-curator/./src/stores/AuthService.js","webpack://gene-curator/./src/components/LoadingDialog.vue","webpack://gene-curator/./src/components/LoadingDialog.vue?a456","webpack://gene-curator/./src/views/LoginUser.vue","webpack://gene-curator/./src/views/LoginUser.vue?f564"],"sourcesContent":["// stores/AuthService.js\nimport { auth } from '@/firebase';\nimport {\n  signInWithPopup,\n  GoogleAuthProvider,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  signOut\n} from 'firebase/auth';\nimport { createUser, getUserByEmail, getUsers } from '@/stores/usersStore'; // Import usersStore functions\n\nconst AuthService = {\n  signInWithGoogle: async () => {\n    try {\n      const provider = new GoogleAuthProvider();\n      const result = await signInWithPopup(auth, provider);\n      await handleFirstLogin(result.user);\n      const userData = await getUserByEmail(result.user.email); // Retrieve user data\n      return userData;\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  },\n\n  registerWithEmail: async (email, password) => {\n    try {\n      const result = await createUserWithEmailAndPassword(auth, email, password);\n      await handleFirstLogin(result.user);\n      const userData = await getUserByEmail(result.user.email); // Retrieve user data\n      return userData;\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  },\n\n  loginWithEmail: async (email, password) => {\n    try {\n      const result = await signInWithEmailAndPassword(auth, email, password);\n      const userData = await getUserByEmail(result.user.email); // Retrieve user data\n      return userData;\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  },\n\n  signOut: async () => {\n    try {\n      await signOut(auth);\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  }\n};\n\nasync function handleFirstLogin(user) {\n  const existingUser = await getUserByEmail(user.email);\n  if (!existingUser) {\n    const users = await getUsers();\n    const isFirstUser = Object.keys(users).length === 0;\n    const role = isFirstUser ? 'admin' : 'viewer';\n\n    await createUser({\n      uid: user.uid,\n      email: user.email,\n      role: role,\n      createdAt: new Date(),\n      updatedAt: new Date()\n    },\n    user.uid);\n  }\n}\n\nexport default AuthService;\n","<template>\n  <v-dialog\n    width=\"200\"\n    :value=\"value\"\n    @input=\"$emit('value', false)\"\n    persistent\n  >\n    <v-card\n      style=\"\n        padding: 20px;\n        text-align: left;\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n      \"\n    >\n      <v-progress-circular indeterminate color=\"primary\" />\n      <p style=\"margin-left: 20px; margin-bottom: 0\">{{ message }}</p>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nexport default {\n  name: \"LoadingDialog\",\n\n  model: {\n    prop: \"value\",\n    event: \"value\",\n  },\n\n  props: {\n    value: {\n      type: Boolean,\n      default: false,\n    },\n\n    message: {\n      type: String,\n      default: \"\",\n    },\n  },\n};\n</script>\n","import { render } from \"./LoadingDialog.vue?vue&type=template&id=de31d18e\"\nimport script from \"./LoadingDialog.vue?vue&type=script&lang=js\"\nexport * from \"./LoadingDialog.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!-- views/LoginUser.vue -->\n<template>\n  <v-container class=\"fill-height d-flex align-center justify-center\">\n    <v-card class=\"pa-5\" style=\"width: 600px\">\n      <v-card-title class=\"text-center text-h5 mb-4\">Login</v-card-title>\n      <v-card-text>\n        <v-form ref=\"loginForm\" @submit.prevent=\"loginWithEmail\">\n          <v-text-field\n            color=\"primary\"\n            label=\"Email\"\n            v-model=\"email\"\n            type=\"email\"\n            :rules=\"[\n              (v) => !!v || 'Email is required',\n              (v) => /.+@.+/.test(v) || 'Email must be valid',\n            ]\"\n            variant=\"outlined\"\n            class=\"mb-2\"\n          ></v-text-field>\n          <v-text-field\n            color=\"primary\"\n            label=\"Password\"\n            v-model=\"password\"\n            type=\"password\"\n            :rules=\"[\n              (v) => !!v && v.length >= 6 || 'Password must be at least 6 characters',\n            ]\"\n            variant=\"outlined\"\n          ></v-text-field>\n\n\n          <div class=\"d-flex justify-space-between align-center mt-2\">\n            <v-btn type=\"submit\" color=\"primary\">Login</v-btn>\n\n            <v-btn\n              @click=\"navigateToRegister\"\n              variant=\"text\"\n              class=\"text-decoration-underlined\"\n            >\n              Don't have an account? Register\n            </v-btn>\n          </div>\n\n          <div class=\"login-divider\">OR</div>\n\n          <v-btn @click=\"signInWithGoogle\" color=\"primary\">\n            Login with Google</v-btn\n          >\n        </v-form>\n      </v-card-text>\n    </v-card>\n\n    <!-- loading dialog component -->\n    <loading-dialog v-model=\"loading\" message=\"Please wait...\" />\n\n    <!-- Message Snackbar for feedback -->\n    <MessageSnackbar\n      v-model=\"snackbarVisible\"\n      :title=\"snackbarTitle\"\n      :message=\"snackbarMessage\"\n      :color=\"snackbarColor\"\n    />\n  </v-container>\n</template>\n\n<script>\nimport AuthService from \"@/stores/AuthService\";\nimport { useRouter } from \"vue-router\"; // Import useRouter\nimport LoadingDialog from \"@/components/LoadingDialog\";\n\nexport default {\n  name: \"LoginUser\",\n  components: {\n    LoadingDialog,\n  },\n  data() {\n    return {\n      loading: false,\n\n      email: \"\",\n      password: \"\",\n      snackbarVisible: false,\n      snackbarMessage: '',\n      snackbarTitle: '',\n      snackbarColor: '',\n    };\n  },\n  setup() {\n    const router = useRouter(); // Use the useRouter hook\n\n    return { router }; // Return router to use it inside methods\n  },\n  methods: {\n    showSnackbar(title, message, color) {\n      this.snackbarTitle = title;\n      this.snackbarMessage = message;\n      this.snackbarColor = color;\n      this.snackbarVisible = true;\n    },\n\n    async loginWithEmail() {\n      const { valid } = await this.$refs.loginForm.validate();\n      if (!valid) return;\n\n      try {\n        this.loading = true;\n        const user = await AuthService.loginWithEmail(\n          this.email,\n          this.password\n        );\n        // Handle successful login\n        this.saveUserToLocalStorage(user);\n        this.router.push(\"/\"); // Redirect to home page after successful login\n        this.showSnackbar('Success', 'Logged in successfully', 'success');\n        this.loading = false;\n      } catch (error) {\n        this.loading = false;\n        this.showSnackbar('Error', 'There was an error logging you in. Please try again.', 'error');\n      }\n    },\n    async signInWithGoogle() {\n      try {\n        const user = await AuthService.signInWithGoogle();\n        // Handle successful login\n        this.saveUserToLocalStorage(user);\n        this.router.push(\"/\"); // Redirect to home page after successful login\n        this.showSnackbar('Success', 'Logged in with Google successfully', 'success');\n      } catch (error) {\n        this.showSnackbar('Error', 'There was an error logging you in with Google. Please try again.', 'error');\n      }\n    },\n    navigateToRegister() {\n      this.router.push(\"/register\");\n    },\n    saveUserToLocalStorage(user) {\n      if (user) {\n        localStorage.setItem(\n          \"user\",\n          JSON.stringify({\n            email: user.email,\n            displayName: user.displayName || user.email,\n            uid: user.uid,\n            role: user.role || 'viewer',\n            permissions: user.permissions,\n          })\n        );\n        localStorage.setItem(\"isLoggedIn\", \"true\");\n      }\n    },\n  },\n};\n</script>\n\n<style>\n.login-divider {\n  text-align: center;\n  margin: 20px 0;\n  color: #757575;\n  display: flex;\n  align-items: center;\n}\n</style>\n","import { render } from \"./LoginUser.vue?vue&type=template&id=034a0ef6\"\nimport script from \"./LoginUser.vue?vue&type=script&lang=js\"\nexport * from \"./LoginUser.vue?vue&type=script&lang=js\"\n\nimport \"./LoginUser.vue?vue&type=style&index=0&id=034a0ef6&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["AuthService","signInWithGoogle","async","provider","GoogleAuthProvider","result","signInWithPopup","auth","handleFirstLogin","user","userData","getUserByEmail","email","error","console","registerWithEmail","password","createUserWithEmailAndPassword","loginWithEmail","signInWithEmailAndPassword","signOut","existingUser","users","getUsers","isFirstUser","Object","keys","length","role","createUser","uid","createdAt","Date","updatedAt","style","_createBlock","_component_v_dialog","width","value","$props","onInput","_cache","$event","_ctx","$emit","persistent","_createVNode","_component_v_card","_component_v_progress_circular","indeterminate","color","_createElementVNode","_hoisted_1","_toDisplayString","message","name","model","prop","event","props","type","Boolean","default","String","__exports__","render","class","_component_v_container","_component_v_card_title","_component_v_card_text","_component_v_form","ref","onSubmit","_withModifiers","$options","_component_v_text_field","label","$data","rules","v","test","variant","_component_v_btn","onClick","navigateToRegister","_hoisted_2","_component_loading_dialog","loading","_component_MessageSnackbar","snackbarVisible","title","snackbarTitle","snackbarMessage","snackbarColor","components","LoadingDialog","data","setup","router","useRouter","methods","showSnackbar","this","valid","$refs","loginForm","validate","saveUserToLocalStorage","push","localStorage","setItem","JSON","stringify","displayName","permissions"],"sourceRoot":""}