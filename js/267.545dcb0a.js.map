{"version":3,"file":"js/267.545dcb0a.js","mappings":"yJAWA,MAAMA,EAAc,CAClBC,iBAAkBC,UAChB,IACE,MAAMC,EAAW,IAAIC,EAAAA,GACfC,QAAeC,EAAAA,EAAAA,IAAgBC,EAAAA,EAAMJ,SACrCK,EAAiBH,EAAOI,MAC9B,MAAMC,QAAiBC,EAAAA,EAAAA,IAAeN,EAAOI,KAAKG,OAClD,OAAOF,CACT,CAAE,MAAOG,GAEP,MADAC,QAAQD,MAAMA,GACRA,CACR,GAGFE,kBAAmBb,MAAOU,EAAOI,KAC/B,IACE,MAAMX,QAAeY,EAAAA,EAAAA,IAA+BV,EAAAA,EAAMK,EAAOI,SAC3DR,EAAiBH,EAAOI,MAC9B,MAAMC,QAAiBC,EAAAA,EAAAA,IAAeN,EAAOI,KAAKG,OAClD,OAAOF,CACT,CAAE,MAAOG,GAEP,MADAC,QAAQD,MAAMA,GACRA,CACR,GAGFK,eAAgBhB,MAAOU,EAAOI,KAC5B,IACE,MAAMX,QAAec,EAAAA,EAAAA,IAA2BZ,EAAAA,EAAMK,EAAOI,GACvDN,QAAiBC,EAAAA,EAAAA,IAAeN,EAAOI,KAAKG,OAClD,OAAOF,CACT,CAAE,MAAOG,GAEP,MADAC,QAAQD,MAAMA,GACRA,CACR,GAGFO,QAASlB,UACP,UACQkB,EAAAA,EAAAA,IAAQb,EAAAA,EAChB,CAAE,MAAOM,GAEP,MADAC,QAAQD,MAAMA,GACRA,CACR,IAIJX,eAAeM,EAAiBC,GAC9B,MAAMY,QAAqBV,EAAAA,EAAAA,IAAeF,EAAKG,OAC/C,IAAKS,EAAc,CACjB,MAAMC,QAAcC,EAAAA,EAAAA,MACdC,EAA4C,IAA9BC,OAAOC,KAAKJ,GAAOK,OACjCC,EAAOJ,EAAc,QAAU,eAE/BK,EAAAA,EAAAA,IAAW,CACfC,IAAKrB,EAAKqB,IACVlB,MAAOH,EAAKG,MACZgB,KAAMA,EACNG,UAAW,IAAIC,KACfC,UAAW,IAAID,MAEjBvB,EAAKqB,IACP,CACF,CAEA,K,sSC3EEI,EAAAA,EAAAA,IAiBWC,EAAA,CAjBDC,MAAM,OAAK,C,kBACnB,IAeS,EAfTC,EAAAA,EAAAA,IAeSC,EAAA,CAfDC,MAAA,oBAAuB,C,kBAC7B,IAIe,EAJfF,EAAAA,EAAAA,IAIeG,EAAA,CAHbD,MAAA,8DAA6D,C,kBAE7D,IAAiB,mBAAdE,EAAA5B,MAAM6B,OAAK,M,OAEhBL,EAAAA,EAAAA,IAEcM,EAAA,M,kBADZ,IAAmB,mBAAhBF,EAAA5B,MAAM+B,SAAO,M,OAElBP,EAAAA,EAAAA,IAKiBQ,EAAA,M,kBAJf,IAAY,EAAZR,EAAAA,EAAAA,IAAYS,IACZT,EAAAA,EAAAA,IAECU,EAAA,CAFMC,MAAM,UAAUC,UAAU,IAAKC,QAAKC,EAAA,KAAAA,EAAA,GAAAC,GAAEC,EAAAC,MAAM,SAAS,K,mBACzD,IAAE,UAAF,S,iCAQX,OACEC,KAAM,cAENC,MAAO,CACL3C,MAAO,CACL4C,KAAMhC,OACNiC,QAASA,KAAA,CAAS,M,QCvBxB,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O,wFCUSrB,MAAA,4C,8HAhBPL,EAAAA,EAAAA,IAkBWC,EAAA,CAjBTC,MAAM,MACLyB,MAAOpB,EAAAoB,MACPC,QAAKX,EAAA,KAAAA,EAAA,GAAAC,GAAEC,EAAAC,MAAM,SAAS,IACvBS,WAAA,I,mBAEA,IAWS,EAXT1B,EAAAA,EAAAA,IAWSC,EAAA,CAVPC,MAAA,mGAMC,C,kBAED,IAAqD,EAArDF,EAAAA,EAAAA,IAAqD2B,EAAA,CAAhCC,cAAA,GAAcjB,MAAM,aACzCkB,EAAAA,EAAAA,GAAgE,IAAhEC,GAAgEC,EAAAA,EAAAA,IAAd3B,EAAAG,SAAO,M,2BAM/D,OACEW,KAAM,gBAENc,MAAO,CACLC,KAAM,QACNC,MAAO,SAGTf,MAAO,CACLK,MAAO,CACLJ,KAAMe,QACNd,SAAS,GAGXd,QAAS,CACPa,KAAMgB,OACNf,QAAS,M,QClCf,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O,qGCwBec,MAAM,kD,GAYXR,EAAAA,EAAAA,GAAmC,OAA9BQ,MAAM,iBAAgB,MAAE,G,gRAzCrCxC,EAAAA,EAAAA,IAwDcyC,EAAA,CAxDDD,MAAM,kDAAgD,C,kBACjE,IA+CS,EA/CTrC,EAAAA,EAAAA,IA+CSC,EAAA,CA/CDoC,MAAM,OAAOnC,MAAA,iB,mBACnB,IAAmE,EAAnEF,EAAAA,EAAAA,IAAmEG,EAAA,CAArDkC,MAAM,4BAA0B,C,kBAAC,IAAK,UAAL,Y,OAC/CrC,EAAAA,EAAAA,IA4CcM,EAAA,M,kBA3CZ,IA0CS,EA1CTN,EAAAA,EAAAA,IA0CSuC,EAAA,CA1CDC,IAAI,YAAaC,UAAMC,EAAAA,EAAAA,IAAUC,EAAA9D,eAAc,c,mBACrD,IAWgB,EAXhBmB,EAAAA,EAAAA,IAWgB4C,EAAA,CAVdjC,MAAM,UACNkC,MAAM,Q,WACGC,EAAAvE,M,qCAAAuE,EAAAvE,MAAKwC,GACdK,KAAK,QACJ2B,MAAK,CAAmBC,KAAQA,GAAC,oBAAwCA,GAAC,QAAaC,KAAKD,IAAC,uBAI9FE,QAAQ,WACRb,MAAM,Q,gCAERrC,EAAAA,EAAAA,IASgB4C,EAAA,CARdjC,MAAM,UACNkC,MAAM,W,WACGC,EAAAnE,S,qCAAAmE,EAAAnE,SAAQoC,GACjBK,KAAK,WACJ2B,MAAK,CAAmBC,KAAQA,GAAKA,EAAE1D,QAAM,6CAG9C4D,QAAQ,Y,gCAIVrB,EAAAA,EAAAA,GAUM,MAVNC,EAUM,EATJ9B,EAAAA,EAAAA,IAAkDU,EAAA,CAA3CU,KAAK,SAAST,MAAM,W,mBAAU,IAAK,UAAL,Y,OAErCX,EAAAA,EAAAA,IAMQU,EAAA,CALLG,QAAO8B,EAAAQ,mBACRD,QAAQ,OACRb,MAAM,8B,mBACP,IAED,UAFC,wC,sBAKHe,GAEApD,EAAAA,EAAAA,IAECU,EAAA,CAFOG,QAAO8B,EAAA/E,iBAAkB+C,MAAM,W,mBAAU,IAC9B,UAD8B,yB,+DAOvDX,EAAAA,EAAAA,IAIgBqD,EAAA,C,WAHLP,EAAAtE,M,qCAAAsE,EAAAtE,MAAKuC,GACbvC,MAAOsE,EAAAQ,SACPC,QAAKzC,EAAA,KAAAA,EAAA,GAAAC,GAAE+B,EAAAtE,MAAQuC,I,gCAElBf,EAAAA,EAAAA,IAA6DwD,EAAA,C,WAApCV,EAAAW,Q,qCAAAX,EAAAW,QAAO1C,GAAER,QAAQ,kB,iFAU9C,GACEW,KAAM,YACNwC,WAAY,CACVC,YAAW,IACXC,cAAaA,EAAAA,GAEfC,IAAAA,GACE,MAAO,CACLrF,OAAO,EACP8E,SAAU,CAAC,EACXG,SAAS,EAETlF,MAAO,GACPI,SAAU,GAEd,EACAmF,KAAAA,GACE,MAAMC,GAASC,EAAAA,EAAAA,MAEf,MAAO,CAAED,SACX,EACAE,QAAS,CACP,oBAAMpF,GACJ,MAAM,MAAEqF,SAAgBC,KAAKC,MAAMC,UAAUC,WAC7C,GAAKJ,EAEL,IACEC,KAAKV,SAAU,EACf,MAAMrF,QAAaT,EAAAA,EAAYkB,eAC7BsF,KAAK5F,MACL4F,KAAKxF,UAGPwF,KAAKI,uBAAuBnG,GAC5B+F,KAAKJ,OAAOS,KAAK,KACjBL,KAAKV,SAAU,CACjB,CAAE,MAAOjF,GACP2F,KAAKV,SAAU,EACfhF,QAAQD,MAAMA,GAEd2F,KAAK3F,OAAQ,EACb2F,KAAKb,SAAW,CACdjD,MAAO,cACPE,QAAS,uDAEb,CACF,EACA,sBAAM3C,GACJ,IACE,MAAMQ,QAAaT,EAAAA,EAAYC,mBAE/BuG,KAAKI,uBAAuBnG,GAC5B+F,KAAKJ,OAAOS,KAAK,IACnB,CAAE,MAAOhG,GACPC,QAAQD,MAAMA,GAEd2F,KAAK3F,OAAQ,EACb2F,KAAKb,SAAW,CACdjD,MAAO,cACPE,QACE,mEAEN,CACF,EACA4C,kBAAAA,GACEgB,KAAKJ,OAAOS,KAAK,YACnB,EACAD,sBAAAA,CAAuBnG,GACjBA,IACFqG,aAAaC,QACX,OACAC,KAAKC,UAAU,CACbrG,MAAOH,EAAKG,MACZsG,YAAazG,EAAKyG,aAAezG,EAAKG,MACtCkB,IAAKrB,EAAKqB,IACVF,KAAMnB,EAAKmB,MAAQ,SACnBuF,YAAa1G,EAAK0G,eAGtBL,aAAaC,QAAQ,aAAc,QAEvC,I,QC7IJ,MAAMpD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://gene-curator/./src/stores/AuthService.js","webpack://gene-curator/./src/components/ErrorDialog.vue","webpack://gene-curator/./src/components/ErrorDialog.vue?aa44","webpack://gene-curator/./src/components/LoadingDialog.vue","webpack://gene-curator/./src/components/LoadingDialog.vue?a456","webpack://gene-curator/./src/views/LoginUser.vue","webpack://gene-curator/./src/views/LoginUser.vue?f564"],"sourcesContent":["// stores/AuthService.js\nimport { auth } from '@/firebase';\nimport {\n  signInWithPopup,\n  GoogleAuthProvider,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  signOut\n} from 'firebase/auth';\nimport { createUser, getUserByEmail, getUsers } from '@/stores/usersStore'; // Import usersStore functions\n\nconst AuthService = {\n  signInWithGoogle: async () => {\n    try {\n      const provider = new GoogleAuthProvider();\n      const result = await signInWithPopup(auth, provider);\n      await handleFirstLogin(result.user);\n      const userData = await getUserByEmail(result.user.email); // Retrieve user data\n      return userData;\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  },\n\n  registerWithEmail: async (email, password) => {\n    try {\n      const result = await createUserWithEmailAndPassword(auth, email, password);\n      await handleFirstLogin(result.user);\n      const userData = await getUserByEmail(result.user.email); // Retrieve user data\n      return userData;\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  },\n\n  loginWithEmail: async (email, password) => {\n    try {\n      const result = await signInWithEmailAndPassword(auth, email, password);\n      const userData = await getUserByEmail(result.user.email); // Retrieve user data\n      return userData;\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  },\n\n  signOut: async () => {\n    try {\n      await signOut(auth);\n    } catch (error) {\n      console.error(error);\n      throw error;\n    }\n  }\n};\n\nasync function handleFirstLogin(user) {\n  const existingUser = await getUserByEmail(user.email);\n  if (!existingUser) {\n    const users = await getUsers();\n    const isFirstUser = Object.keys(users).length === 0;\n    const role = isFirstUser ? 'admin' : 'viewer';\n\n    await createUser({\n      uid: user.uid,\n      email: user.email,\n      role: role,\n      createdAt: new Date(),\n      updatedAt: new Date()\n    },\n    user.uid);\n  }\n}\n\nexport default AuthService;\n","<template>\n  <v-dialog width=\"470\">\n    <v-card style=\"padding: 10px 0\">\n      <v-card-title\n        style=\"font-family: google-sans, sans-serif; font-size: 24px\"\n      >\n        {{ error.title }}\n      </v-card-title>\n      <v-card-text>\n        {{ error.message }}\n      </v-card-text>\n      <v-card-actions>\n        <v-spacer />\n        <v-btn color=\"primary\" elevation=\"0\" @click=\"$emit('value', false)\"\n          >Ok</v-btn\n        >\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nexport default {\n  name: \"ErrorDialog\",\n\n  props: {\n    error: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n};\n</script>\n","import { render } from \"./ErrorDialog.vue?vue&type=template&id=ccef2fcc\"\nimport script from \"./ErrorDialog.vue?vue&type=script&lang=js\"\nexport * from \"./ErrorDialog.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <v-dialog\n    width=\"200\"\n    :value=\"value\"\n    @input=\"$emit('value', false)\"\n    persistent\n  >\n    <v-card\n      style=\"\n        padding: 20px;\n        text-align: left;\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n      \"\n    >\n      <v-progress-circular indeterminate color=\"primary\" />\n      <p style=\"margin-left: 20px; margin-bottom: 0\">{{ message }}</p>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nexport default {\n  name: \"LoadingDialog\",\n\n  model: {\n    prop: \"value\",\n    event: \"value\",\n  },\n\n  props: {\n    value: {\n      type: Boolean,\n      default: false,\n    },\n\n    message: {\n      type: String,\n      default: \"\",\n    },\n  },\n};\n</script>\n","import { render } from \"./LoadingDialog.vue?vue&type=template&id=de31d18e\"\nimport script from \"./LoadingDialog.vue?vue&type=script&lang=js\"\nexport * from \"./LoadingDialog.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!-- views/LoginUser.vue -->\n<template>\n  <v-container class=\"fill-height d-flex align-center justify-center\">\n    <v-card class=\"pa-5\" style=\"width: 600px\">\n      <v-card-title class=\"text-center text-h5 mb-4\">Login</v-card-title>\n      <v-card-text>\n        <v-form ref=\"loginForm\" @submit.prevent=\"loginWithEmail\">\n          <v-text-field\n            color=\"primary\"\n            label=\"Email\"\n            v-model=\"email\"\n            type=\"email\"\n            :rules=\"[\n              (v) => !!v || 'Email is required',\n              (v) => /.+@.+/.test(v) || 'Email must be valid',\n            ]\"\n            variant=\"outlined\"\n            class=\"mb-2\"\n          ></v-text-field>\n          <v-text-field\n            color=\"primary\"\n            label=\"Password\"\n            v-model=\"password\"\n            type=\"password\"\n            :rules=\"[\n              (v) => !!v && v.length >= 6 || 'Password must be at least 6 characters',\n            ]\"\n            variant=\"outlined\"\n          ></v-text-field>\n\n\n          <div class=\"d-flex justify-space-between align-center mt-2\">\n            <v-btn type=\"submit\" color=\"primary\">Login</v-btn>\n\n            <v-btn\n              @click=\"navigateToRegister\"\n              variant=\"text\"\n              class=\"text-decoration-underlined\"\n            >\n              Don't have an account? Register\n            </v-btn>\n          </div>\n\n          <div class=\"login-divider\">OR</div>\n\n          <v-btn @click=\"signInWithGoogle\" color=\"primary\">\n            Login with Google</v-btn\n          >\n        </v-form>\n      </v-card-text>\n    </v-card>\n\n    <error-dialog\n      v-model=\"error\"\n      :error=\"errorVal\"\n      @value=\"error = $event\"\n    ></error-dialog>\n    <loading-dialog v-model=\"loading\" message=\"Please wait...\" />\n  </v-container>\n</template>\n\n<script>\nimport AuthService from \"@/stores/AuthService\";\nimport { useRouter } from \"vue-router\"; // Import useRouter\nimport ErrorDialog from \"@/components/ErrorDialog\";\nimport LoadingDialog from \"@/components/LoadingDialog\";\n\nexport default {\n  name: \"LoginUser\",\n  components: {\n    ErrorDialog,\n    LoadingDialog,\n  },\n  data() {\n    return {\n      error: false,\n      errorVal: {},\n      loading: false,\n\n      email: \"\",\n      password: \"\",\n    };\n  },\n  setup() {\n    const router = useRouter(); // Use the useRouter hook\n\n    return { router }; // Return router to use it inside methods\n  },\n  methods: {\n    async loginWithEmail() {\n      const { valid } = await this.$refs.loginForm.validate();\n      if (!valid) return;\n\n      try {\n        this.loading = true;\n        const user = await AuthService.loginWithEmail(\n          this.email,\n          this.password\n        );\n        // Handle successful login\n        this.saveUserToLocalStorage(user);\n        this.router.push(\"/\"); // Redirect to home page after successful login\n        this.loading = false;\n      } catch (error) {\n        this.loading = false;\n        console.error(error);\n\n        this.error = true;\n        this.errorVal = {\n          title: \"Login Error\",\n          message: \"There was an error logging you in. Please try again.\",\n        };\n      }\n    },\n    async signInWithGoogle() {\n      try {\n        const user = await AuthService.signInWithGoogle();\n        // Handle successful login\n        this.saveUserToLocalStorage(user);\n        this.router.push(\"/\"); // Redirect to home page after successful login\n      } catch (error) {\n        console.error(error);\n\n        this.error = true;\n        this.errorVal = {\n          title: \"Login Error\",\n          message:\n            \"There was an error logging you in with Google. Please try again.\",\n        };\n      }\n    },\n    navigateToRegister() {\n      this.router.push(\"/register\");\n    },\n    saveUserToLocalStorage(user) {\n      if (user) {\n        localStorage.setItem(\n          \"user\",\n          JSON.stringify({\n            email: user.email,\n            displayName: user.displayName || user.email,\n            uid: user.uid,\n            role: user.role || 'viewer',\n            permissions: user.permissions,\n          })\n        );\n        localStorage.setItem(\"isLoggedIn\", \"true\");\n      }\n    },\n  },\n};\n</script>\n\n<style>\n.login-divider {\n  text-align: center;\n  margin: 20px 0;\n  color: #757575;\n  display: flex;\n  align-items: center;\n}\n</style>\n","import { render } from \"./LoginUser.vue?vue&type=template&id=5de85a96\"\nimport script from \"./LoginUser.vue?vue&type=script&lang=js\"\nexport * from \"./LoginUser.vue?vue&type=script&lang=js\"\n\nimport \"./LoginUser.vue?vue&type=style&index=0&id=5de85a96&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["AuthService","signInWithGoogle","async","provider","GoogleAuthProvider","result","signInWithPopup","auth","handleFirstLogin","user","userData","getUserByEmail","email","error","console","registerWithEmail","password","createUserWithEmailAndPassword","loginWithEmail","signInWithEmailAndPassword","signOut","existingUser","users","getUsers","isFirstUser","Object","keys","length","role","createUser","uid","createdAt","Date","updatedAt","_createBlock","_component_v_dialog","width","_createVNode","_component_v_card","style","_component_v_card_title","$props","title","_component_v_card_text","message","_component_v_card_actions","_component_v_spacer","_component_v_btn","color","elevation","onClick","_cache","$event","_ctx","$emit","name","props","type","default","__exports__","render","value","onInput","persistent","_component_v_progress_circular","indeterminate","_createElementVNode","_hoisted_1","_toDisplayString","model","prop","event","Boolean","String","class","_component_v_container","_component_v_form","ref","onSubmit","_withModifiers","$options","_component_v_text_field","label","$data","rules","v","test","variant","navigateToRegister","_hoisted_2","_component_error_dialog","errorVal","onValue","_component_loading_dialog","loading","components","ErrorDialog","LoadingDialog","data","setup","router","useRouter","methods","valid","this","$refs","loginForm","validate","saveUserToLocalStorage","push","localStorage","setItem","JSON","stringify","displayName","permissions"],"sourceRoot":""}